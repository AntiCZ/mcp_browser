<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BrowserMCP Click Fix Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
        }
        .test-section {
            border: 1px solid #ddd;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }
        button {
            padding: 10px 20px;
            margin: 10px;
            cursor: pointer;
            font-size: 16px;
        }
        #output {
            background: #f5f5f5;
            padding: 10px;
            margin-top: 20px;
            border-radius: 3px;
            min-height: 100px;
            white-space: pre-wrap;
        }
        .success { color: green; }
        .error { color: red; }
        .info { color: blue; }
    </style>
</head>
<body>
    <h1>BrowserMCP Click Fix Test Suite</h1>
    <p>This page tests various click scenarios to verify the browser_click fix works properly.</p>

    <div class="test-section">
        <h2>Test 1: Basic onclick attribute</h2>
        <button onclick="logClick('Test 1: onclick attribute clicked')">
            Click Me (onclick)
        </button>
    </div>

    <div class="test-section">
        <h2>Test 2: addEventListener</h2>
        <button id="addEventListener-btn">
            Click Me (addEventListener)
        </button>
    </div>

    <div class="test-section">
        <h2>Test 3: React-style Synthetic Events</h2>
        <button id="synthetic-btn">
            Click Me (Synthetic)
        </button>
    </div>

    <div class="test-section">
        <h2>Test 4: Event Property Check</h2>
        <button id="trusted-btn">
            Click Me (Checks isTrusted)
        </button>
    </div>

    <div class="test-section">
        <h2>Test 5: Form Submit Button</h2>
        <form id="test-form" onsubmit="handleSubmit(event); return false;">
            <input type="text" name="test-input" placeholder="Enter text">
            <button type="submit">Submit Form</button>
        </form>
    </div>

    <div class="test-section">
        <h2>Test 6: Link Navigation</h2>
        <a href="#section-anchor" id="test-link">Navigate to Anchor</a>
        <div id="section-anchor" style="margin-top: 20px; padding: 10px; background: #e0e0e0;">
            Anchor destination
        </div>
    </div>

    <div class="test-section">
        <h2>Test 7: Checkbox Toggle</h2>
        <label>
            <input type="checkbox" id="test-checkbox" onchange="logClick('Test 7: Checkbox toggled')">
            Toggle this checkbox
        </label>
    </div>

    <div class="test-section">
        <h2>Test 8: Focus Test</h2>
        <button id="focus-btn">
            Click Me (Should receive focus)
        </button>
    </div>

    <div class="test-section">
        <h2>Test 9: Hover Test</h2>
        <button id="hover-btn" style="transition: all 0.3s;">
            Hover over me
        </button>
    </div>

    <div class="test-section">
        <h2>Test 10: OAuth Simulation</h2>
        <button data-action="connect" id="oauth-btn">
            Connect OAuth (Opens Alert)
        </button>
    </div>

    <h3>Output Log:</h3>
    <div id="output"></div>

    <script>
        const output = document.getElementById('output');
        
        function log(message, className = '') {
            const timestamp = new Date().toLocaleTimeString();
            const entry = document.createElement('div');
            entry.className = className;
            entry.textContent = `[${timestamp}] ${message}`;
            output.appendChild(entry);
            console.log(message);
        }

        function logClick(message) {
            log(message, 'success');
        }

        // Test 2: addEventListener
        document.getElementById('addEventListener-btn').addEventListener('click', function(e) {
            log(`Test 2: addEventListener clicked (isTrusted: ${e.isTrusted})`, 'success');
        });

        // Test 3: React-style synthetic events
        const syntheticBtn = document.getElementById('synthetic-btn');
        syntheticBtn.addEventListener('click', function(e) {
            log(`Test 3: Synthetic event clicked`, 'success');
            log(`  Event details: clientX=${e.clientX}, clientY=${e.clientY}, button=${e.button}`, 'info');
        });

        // Test 4: Event property check
        document.getElementById('trusted-btn').addEventListener('click', function(e) {
            if (e.isTrusted) {
                log('Test 4: REAL user click detected (isTrusted=true)', 'success');
            } else {
                log('Test 4: Programmatic click detected (isTrusted=false)', 'info');
            }
            log(`  Coordinates: (${e.clientX}, ${e.clientY})`, 'info');
            log(`  Event type: ${e.type}, bubbles: ${e.bubbles}`, 'info');
        });

        // Test 5: Form submission
        function handleSubmit(e) {
            e.preventDefault();
            const formData = new FormData(e.target);
            log(`Test 5: Form submitted with data: ${formData.get('test-input')}`, 'success');
        }

        // Test 6: Link navigation
        document.getElementById('test-link').addEventListener('click', function(e) {
            log('Test 6: Link clicked, navigating to anchor', 'success');
        });

        // Test 8: Focus test
        document.getElementById('focus-btn').addEventListener('click', function() {
            log('Test 8: Button clicked', 'success');
        });
        document.getElementById('focus-btn').addEventListener('focus', function() {
            log('Test 8: Button received focus', 'info');
        });

        // Test 9: Hover test
        const hoverBtn = document.getElementById('hover-btn');
        hoverBtn.addEventListener('mouseenter', function() {
            this.style.background = '#4CAF50';
            this.style.color = 'white';
            log('Test 9: Mouse entered button', 'info');
        });
        hoverBtn.addEventListener('mouseleave', function() {
            this.style.background = '';
            this.style.color = '';
            log('Test 9: Mouse left button', 'info');
        });
        hoverBtn.addEventListener('mouseover', function(e) {
            log(`Test 9: Mouseover at (${e.clientX}, ${e.clientY})`, 'info');
        });

        // Test 10: OAuth simulation
        document.querySelector('[data-action="connect"]').addEventListener('click', function() {
            log('Test 10: OAuth button clicked!', 'success');
            alert('OAuth window would open here');
            // In real scenario, this would be: window.open('/oauth/authorize', 'oauth', 'width=500,height=600');
        });

        // Log page ready
        log('Test page loaded and ready', 'info');
        log('Use browser_snapshot to get refs, then browser_click to test each button', 'info');
    </script>
</body>
</html>